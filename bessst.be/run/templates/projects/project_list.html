{% extends "base.html" %}

{% block title %}Projecten{% endblock %}

{% block header %}
    <h1 id="info-zone">&nbsp;</h1>
{% endblock header%}

{% block content %}

    <section id="main">
        <ul id="project-list"> 
        {% for axis in axis_list %}
            <li class="logo">
                <img class="{{ axis.pictogram }}" id="{{ axis.name|slugify }}" src="{{ STATIC_URL }}axis/{{ axis.pictogram }}.png" title="{{ axis.name }}" data-photo="{{ axis.image_set.all.0.image.url }}" data-photo-caption="{{ axis.image_set.all.0 }}"/>
          </li>
          {% for project in axis.project_set.all %}
          <li class="box {{ project.axis.name|slugify }} no-border {% if project.archived %}archive{% endif %}" data-sizex="{{ project.size_x }}"><a class="project-list-title" href="{{ project.get_absolute_url }}" data-axis="{{ project.axis.name|slugify }}">{{ project }}</a></li>
          {% endfor %}
        {% endfor %}
        </ul>
    </section>
{% endblock content %}


{% block footer %}
    <footer>
        <div id="caption-list">
                <div class="caption visible">
                    Waerbeke vlinder
                </div>
        </div>
    </footer>




    <script>
        var masonic = function() {
            $('#project-list').masonry({
              itemSelector: 'li',
              columnWidth: 30
            });
        };

        $(window).load(function() {
            /* Hiding the project boxes with jQuery sets display:none; height:0; width:0;
             * We will need the elements to have a width because we need them
             * taken into account in the masonry layout.
             * So initially we just hide them in the css:
             *
             * ul#project-list .box {
             *     visibility: hidden;
             * }
             *
             * Then we calculate the masonry layout:
             */
            masonic();
            /* We also hide them the jQuery way: */
            $("ul#project-list .box").hide();
            /* Now we just have the reset the visibility in the css,
             * so that the elements will show up when toggled: */
            $("ul#project-list .box").css('visibility','visible');
        });

        /* Show axis names and colors on axis-image rollover */
        $("li.logo").hover(function(){
            picto = $(this).children("img");
            filename = picto.attr("src").slice(0, -4);
            picto.attr("src", filename + "_c.png");
            $(this).css({'position': 'relative', 'z-index': '100'});

            $("#info-zone").text(picto.attr('title')).css('visibility','visible').addClass(picto.attr('class'));

            $("." + picto.attr("id")).removeClass("no-border");

            $(this).css({'position': 'relative', 'z-index': '100'});

            // background image and caption
            $("#background-gradient").css("background-image", "url(" + filename + "-gradient.png)");
            $(".background-image").attr("src", picto.attr("data-photo"));
            $("footer .caption").text(picto.attr("data-photo-caption")).show();
        }, function(){
            picto.attr("src", filename + ".png");
            $(this).css({'position': 'absolute', 'z-index': '0'});

            $("#info-zone").html("&nbsp;").css('visibility','hidden').removeClass();
            $("." + picto.attr("id")).addClass("no-border");

        });
        
        /* Show/hide projects on axis-image click */
        $("li.logo").click(function(){
            $('.' + $(this).children("img").attr('id')).toggle('slow', masonic)
        })


        // Rollover on a project box
        $("a.project-list-title").parent().hover(function(){
                axis = $("a", $(this)).attr("data-axis");
                $("." + axis).removeClass("no-border");

                $(this).css({'position': 'relative', 'z-index': '100'});

                picto = $("#" + axis);

                filename = picto.attr("src").slice(0, -4);
                picto.attr("src", filename + "_c.png");

                $("#info-zone").text(picto.attr('title')).css('visibility','visible').addClass(picto.attr('class')).removeClass("no-border");

                $("#background-gradient").css("background-image", "url(" + filename + "-gradient.png)");
                $(".background-image").attr("src", picto.attr("data-photo"));
                $("footer .caption").text(picto.attr("data-photo-caption")).show();
            },function(){
                $("." + axis).addClass("no-border");
                $(this).css({'position': 'absolute', 'z-index': '0'});
                picto.attr("src", filename + ".png");
                $("#info-zone").html("&nbsp;").css('visibility','hidden').removeClass();
        });


        // Toggle boxes when hovering caption box
        $("footer div#caption-list").hover(function(){
                $("section").css("visibility", "hidden");
                $("header").hide();
                $("#background-gradient").hide();
            }, function(){
                $("section").css("visibility", "visible");
                $("header").show();
                $("#background-gradient").show();
        });
    </script>
{% endblock %}
