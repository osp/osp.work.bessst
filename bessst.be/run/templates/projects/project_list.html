{% extends "base.html" %}
{% load markup %}

{% block title %}Projecten{% endblock %}

{% block slug %}projecten{% endblock%}


{% block header %}
    <h1 id="info-zone">&nbsp;</h1>
{% endblock header%}

{% block content %}

    <section id="main">
    <div id='axis-menu'>
        {% for axis in axis_list %}
            <h2 class="logo">
                <a href='{% url axis-detail axis.slug %}'>
                    <img class="{{ axis.pictogram }} small-logo" id="{{ axis.name|slugify }}" src="{{ STATIC_URL }}axis/{{ axis.pictogram }}.png" title="{{ axis.name }}" data-photo="{{ axis.image_set.all.0.image.url }}" data-photo-caption="{{ axis.image_set.all.0 }}"/>
                </a>
          </h2>
        {% endfor %}
    </div>
          <ul id='project-list'>
              {% for project in object_list %}
              <li class="box {{ project.axis.name|slugify }} no-border {% if project.archived %}archive{% endif %}" data-sizex="18">
                  
                  <a class="many-things-link" href="{{ project.get_absolute_url }}" data-axis="{{ project.axis.name|slugify }}">
                  
                    <div> 
                        <h1>{{ project }}</h1>
                        <div class="project-subtitle-lettrine">{{ project.subtitle }}</div>
                        </span>
                    </div>
                    
                    <div class='lettrine'>
                        {% if project.image_set.all.0.image.url %}<img src="{{ project.image_set.all.0.image.url }}" style="width: 100%;" />{% endif %}
                        <img class="{{ project.axis.pictogram }} small-logo" id="{{ project.axis.name|slugify }}" src="{{ STATIC_URL }}axis/{{ project.axis.pictogram }}.png" title="{{ project.axis.name }}" data-photo="{{ project.axis.image_set.all.0.image.url }}" data-photo-caption="{{ project.axis.image_set.all.0 }}"/>
                    </div>
                   
                    {{ project.summary|markdown|truncatewords:40 }}
                 
                    </a>
                    
              </li>
          {% endfor %}
          </ul>
    </section>
{% endblock content %}


{% block background %}
    <img class="background-image projects" id="background-all" src="{{ MEDIA_URL }}images/Waerbeke_vlinder_s.jpg"/>
    {% for axis in axis_list %}
        <img class="background-image axis-image" id="background-{{ axis.name|slugify }}" src="{{ axis.image_set.all.0.image.url }}" />
    {% endfor %}
{% endblock %}


{% block footer %}
    <div id="box-oproep" class="box quote" data-sizex="8"><a href="{{ STATIC_URL }}pdf/projectoproep_bessst.pdf">bessst-labeloproep</a> </div>
    <div id="caption-block">
        <div id="caption-list">
            <div class="caption visible">
                Waerbeke Â© Joke Floreal
            </div>
        </div>
    </div>
{% endblock %}


{% block extra_js %}
    <script>
        var masonic = function() {
            $('#project-list').masonry({
              itemSelector: 'li',
              columnWidth: 30
            });
        };

        $(window).load(function() {
            $("a#menu-projects").addClass('selected');

            /* Hiding the project boxes with jQuery sets display:none; height:0; width:0;
             * We will need the elements to have a width because we need them
             * taken into account in the masonry layout.
             * So initially we just hide them in the css:
             *
             * ul#project-list .box {
             *     visibility: hidden;
             * }
             *
             * Then we calculate the masonry layout:
             */
            masonic();
            /* We also hide them the jQuery way: */
            //$("ul#project-list .box").hide();
            /* Now we just have the reset the visibility in the css,
             * so that the elements will show up when toggled: */
            //$("ul#project-list .box").css('visibility','visible');
            //$("ul#project-list .box.quote").toggle('slow');
        });

        $("img.background-image.axis-image").fadeOut();

        /* ROLLOVER PROJECT BOX */
        $('ul#project-list li').hover(function(){
            $(this).removeClass('no-border');
            }, function(){
            $(this).addClass('no-border');
        });

        /* Show axis names and colors on axis-image rollover */
        $(".logo").hover(function(){
            picto = $( "img", $(this));
            filename = picto.attr("src").slice(0, -4);
            picto.attr("src", filename + "_c.png");

            $("#info-zone").text(picto.attr('title')).css('visibility','visible').addClass(picto.attr('class'));

            $("." + picto.attr("id")).removeClass("no-border");

            // background image and caption
            $('img.background-image').not('img#background-' + picto.attr("id")).fadeOut();
            $('img#background-' + picto.attr("id")).fadeIn();

            console.log('img#background-' + picto.attr("id"))
            $("footer .caption").text(picto.attr("data-photo-caption")).show();
        }, function(){
            picto.attr("src", filename + ".png");

            $("#info-zone").html("&nbsp;").css('visibility','hidden').removeClass();
            $("." + picto.attr("id")).addClass("no-border");

        });
        
        /* Show/hide projects on axis-image click */
        //$("li.logo").click(function(){
        //    $('.' + $(this).children("img").attr('id')).toggle('slow', masonic)
        //})


    </script>
{% endblock %}
